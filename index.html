<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <title>AD Accelarator</title>
    <link rel="icon" type="image/png" href="https://i.ibb.co/mV5hWSsB/CD-logo-removebg-preview.png" style= "max-width: 250px; margin-bottom: 20px; margin-top: 10px;">
    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2c3e50;
            --success-color: #2ecc71;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --info-color: #1abc9c;
        }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 0; background: #f5f5f5; }
        .container { 
            margin-top: 80px; /* Match the header height */
            margin-left: 290px; /* Match the headers left value */
            padding: 20px;
            width: calc(100% - 290px);
            box-sizing: border-box;
            overflow-x: hidden;
            }
        .sidebar {
            width: 250px; position: fixed; left: 0; top: 0; bottom: 0;
            background: var(--secondary-color); color: white; padding: 20px;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
        }
        .sidebar.collapsed { width: 60px; }
        .sidebar.collapsed ul { display: none; }
        .sidebar h3 { margin: 0 0 20px; cursor: pointer; }
        .sidebar ul { list-style: none; padding: 0; }
        .sidebar a { color: white; text-decoration: none; display: block; padding: 10px; }
        .sidebar a:hover { background: rgba(255,255,255,0.1); }
             .sidebar-item a {
            color: inherit;
            text-decoration: none;
            display: flex;
            align-items: center;
            width: 100%;
        }

        .sidebar-item a i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }
        .header {
            position: fixed;
            top: 0;
            left: 290px;
            right: 0;
            height: 60px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white; 
            padding: 20px; 
            border-radius: 5px 5px 0 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            z-index: 1000;
            display: flex;
            justify-content: space-between; 
            align-items: center;
        }
        .card { background: white; margin-bottom: 20px; border-radius: 5px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);
           
        }
        .card:hover { box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        .card-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white; padding: 15px 20px; font-size: 18px; cursor: pointer;
            transition: all 0.3s;
        }
        .card-body { 
            padding: 20px; 
            display: none; 
            overflow: hidden;
            transform-origin: top;
            position: relative;
            z-index: 1;
        }
        .expanded .card-body { display: block; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd; }
        .status { padding: 5px 10px; border-radius: 3px; color: white; }
        .status-success { background: var(--success-color); }
        .status-warning { background: var(--warning-color); }
        .status-danger { background: var(--danger-color); }
        .kpi-container { display: flex; flex-wrap: wrap; gap: 20px; }
        .kpi-card {
            flex:1;
            min-width: 200px; height: 280px; background: white; border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content:center;
            padding: 15px; box-shadow: 0 2px 4px rgba(0,0,255,0.1); text-align: center;
            overflow: hidden;
        }
        
        #maturityGauge {
         width: 120px !important;
        height: 120px !important;
        }

         .kpi-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .kpi-content{
        display: flex;
        flex-direction:column;
        align-items:center;
        }
        .kpi-value { font-size: 58px; font-weight: bold; margin: 10px 0; }
        .kpi-label { font-size: 24px; font-weight: bold; color: #666; }
        
        .chart-container { 
        width: 1200px;  /* Adjust width */
        height: 400px; /* Adjust height */ 
        margin-bottom: 20px; 
        }
        .export-btn { padding: 10px 20px; background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); border: none; color: white; cursor: pointer; border-radius: 5px; }
        .tabs { display: flex; border-bottom: 1px solid #ddd; margin-bottom: 20px; }
        .tab { padding: 10px 20px; cursor: pointer; background: #f9f9f9; border: 1px solid #ddd; border-bottom: none; margin-right: 5px; }
        .tab.active { background: white; font-weight: bold; border-bottom: 1px solid white; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .collapsible { background: #f9f9f9; padding: 15px; margin-bottom: 5px; border-radius: 5px; cursor: pointer; border: 1px solid #ddd; font-weight: bold; }
        .collapsible-content { display: none; padding: 15px; border: 1px solid #ddd; border-top: none; border-radius: 0 0 5px 5px; background: white; }
        .dataTables_wrapper .dataTables_filter input { margin-left: 10px; padding: 5px; }

         /* Footer */
        .footer {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            text-align: center;
            padding: 20px;
            margin-top: 50px;
            margin-left: -20px;
            width: calc(100% + 40px);
            box-shadow: 0 -5px 10px rgba(0,0,0,0.1);
            font-size: 14px;
        }
        
        .footer p {
            margin: 5px 0;
        }
        
        .footer-logo {
            max-width: 150px;
            margin-bottom: 10px;
        }
        
        .footer-links {
            margin-top: 15px;
        }
        
        .footer-links a {
            color: white;
            margin: 0 10px;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        
        .footer-links a:hover {
            color: var(--primary-color);
            text-decoration: underline;
        }
        @media print {
            .sidebar, .export-btn { display: none; }
            .container { margin-left: 0; width: 100%; }
            .card-body { display: block !important; }
            .card-header { background: #f2f2f2; color: #333; }
            .footer { background: none; color: #333; box-shadow: none; }
        }
        /* Description Boxes */
        .description-box {
            background-color: var(--description-color);
            border: 1px solid var(--description-border);
            border-left: 4px solid var(--primary-color);
            border-radius: 6px;
            padding: 15px 20px;
            margin: 15px 0 25px 0;
            position: relative;
            font-size: 15px;
            line-height: 1.6;
            color: var(--description-text);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            animation: fadeIn 0.5s ease;
        }
        
        .description-box .info-icon {
            position: absolute;
            top: 15px;
            left: 15px;
            font-size: 20px;
            color: var(--primary-color);
        }
        
        .description-box p {
            margin: 0 0 10px 0;
            padding-left: 30px;
        }
        
        .description-box ul {
            margin: 10px 0 5px 35px;
            padding: 0;
        }
        
        .description-box li {
            margin-bottom: 5px;
        }
        
        .tab-description {
            font-size: 14px;
            color: #666;
            margin: -5px 0 15px 0;
            font-style: italic;
            border-left: 3px solid var(--primary-color);
            padding-left: 10px;
            line-height: 1.5;
        }
        
        /* Glossary Styles */
        .glossary-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .glossary-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border-left: 3px solid var(--primary-color);
        }
        
        .glossary-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .glossary-item h4 {
            margin-top: 0;
            color: var(--secondary-color);
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
            margin-bottom: 10px;
        }
        
        .glossary-item p {
            margin: 0;
            color: #555;
            font-size: 14px;
            line-height: 1.5;
        }
        
        /* Quick Guide Styles */
        .quick-guide {
            background: white;
            border-radius: 8px;
            margin: 20px 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            overflow: hidden;
            animation: fadeIn 0.5s ease;
        }
        
        .quick-guide-header {
            background: linear-gradient(135deg, #6a89cc, #4a69bd);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .quick-guide-header h3 {
            margin: 0;
            font-size: 18px;
        }
        
        .toggle-guide-btn {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.4);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .toggle-guide-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .quick-guide-content {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: all 0.5s ease;
        }
        
        .quick-guide-content.show {
            padding: 20px;
            max-height: 1000px;
        }
        
        .guide-section {
            margin-bottom: 20px;
        }
        
        .guide-section:last-child {
            margin-bottom: 0;
        }
        
        .guide-section h4 {
            margin-top: 0;
            color: #3a4f6a;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
            margin-bottom: 15px;
        }
        
        .guide-section ul {
            margin: 0 0 0 20px;
            padding: 0;
        }
        
        .guide-section li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        
        .icon-guide {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .icon-guide div {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
        }
        
        .icon-guide .status {
            min-width: 80px;
            text-align: center;
        }
        
        .guide-section a {
            color: var(--primary-color);
            text-decoration: none;
            transition: all 0.3s ease;
        }
        
        .guide-section a:hover {
            text-decoration: underline;
            color: #2980b9;
        }

          .maturity-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .maturity-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }

        .maturity-card:hover {
            transform: translateY(-2px);
        }

        .maturity-card h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .score-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .score-table th, .score-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .score-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }

        .score-table tr:last-child td {
            border-bottom: none;
        }

        .score-table tr:hover {
            background: #f8f9fa;
        }

        .points-badge {
            background: #e9ecef;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.9em;
            color: #495057;
        }

        .maturity-level {
            display: inline-flex;
            align-items: center;
            padding: 6px 12px;
            border-radius: 16px;
            font-weight: 500;
            margin: 5px;
        }

        .level-high {
            background: #d4edda;
            color: #155724;
        }

        .level-medium {
            background: #fff3cd;
            color: #856404;
        }

        .level-low {
            background: #f8d7da;
            color: #721c24;
        }

         .score-table td.current-points {
            text-align: center;
        }

        .points-badge.earned {
            background: #d4edda;
            color: #155724;
        }

        .points-badge.not-earned {
            background: #f8d7da;
            color: #721c24;
        }

    
        html {
            scroll-behavior: smooth;
            scroll-padding-top: 130px;
        }

        .version-info {
            text-align: center;
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
            margin-top: auto;
            padding-top: 10px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body>
  <div class="sidebar" id="sidebar">
    <img src="https://i.ibb.co/Sw37bHqc/cdlogo-full.png" alt="Cloud Destinations Logo" class="footer-logo" style="max-width: 250px; margin-bottom: 23px; margin-top: 10px;">
    <h3><a href=""><i class="fas fa-bars"></i> Accelerator Map</a></h3>
    <ul>
        <li><a href="#executive-summary"><i class="fas fa-chart-line"></i> Executive Summary</a></li>
        <li><a href="#security-indicators"><i class="fas fa-shield-alt"></i> Security Indicators</a></li>
        <li><a href="#quick-guide"><i class="fa-solid fa-circle-info"></i> Quick Guide</a></li>
        <li><a href="#ad-maturity"><i class="fas fa-chart-bar"></i> AD Maturity</a></li>
        <li><a href="#attack-vectors"><i class="fas fa-exclamation-triangle"></i> Attack Vectors</a></li>
        <li><a href="#stale-objects"><i class="fas fa-clock"></i> Stale Objects</a></li>
        <li><a href="#ad-anomalies"><i class="fas fa-search"></i> AD Anomalies</a></li>
        <li><a href="#computer-inventory"><i class="fas fa-desktop"></i> Computer Inventory</a></li>
        <li><a href="#gpos"><i class="fas fa-cogs"></i> GPOs</a></li>
        <li><a href="#glossary"><i class="fas fa-book"></i> Glossary</a></li>
    </ul>
    <div class="version-info">
        <p><img src="https://i.ibb.co/mV5hWSsB/CD-logo-removebg-preview.png"style="width: 20px; height: 20px;" border="0" > AD Accelerator v1.0.0</p>
        <p><i class="fas fa-clock"></i> Last Updated: 2024-03-21 14:30:45</p>
    </div>
</div>
    <div class="container">
        <div class="header">
            <div>
               <div class='domain-info'><th>Domain Name: </th><td>contoso.local</td></div>
                <div class="timestamp">Generated on: <span id="report-date">2024-03-21 14:30:45</span></div>
            </div>
         <div style="display: flex; justify-content: center; align-items: center; height: 100%;">
            <h1 style="margin: 0; font-size: 2rem; text-align: center;">AD Accelerator</h1>
        </div>
          <img src="https://i.ibb.co/mV5hWSsB/CD-logo-removebg-preview.png" alt="CD-logo-removebg-preview" style="width: 80px; height: 80px;" border="0" />
        </div>
                
        <div class="executive-summary" id="executive-summary">
                <h2>Executive Summary</h2>
                <p class="tab-description">This report assesses the AD environment for contoso.local. Maturity Score: <strong>7.5/10</strong> (Advanced).</p>
            <div class="kpi-container">
                <div class="kpi-card status-success">
                <div class="kpi-content">
                    <div class="kpi-label">AD Maturity Score</div>
                    <a href="#ad-maturity">
                    <canvas id="maturityGauge";></canvas></a>
                    <div class="kpi-value">5/10</div>
                    </div>
                </div>
                <div class="kpi-card kpi-info">
                <div class="kpi-content"><div class="kpi-label">Domain Controllers</div><br><br><a href="#security-indicators"><img src="https://i.ibb.co/sYfCtJk/dcicon.png" alt="dcicon" border="0"></a><div class="kpi-value">4</div></div></div>
                <div class="kpi-card kpi-warning"><div class="kpi-content"><div class="kpi-label">Privileged Accounts</div><br><br><a href="#privileged-acc"><img src="https://i.ibb.co/TMMdpQ0w/previliegedcion.png" alt="previliegedcion" border="0"></a><div class="kpi-value">15</div></div></div>
                <div class="kpi-card status-warning"><div class="kpi-content"><div class="kpi-label">Stale Objects</div><br><br><a href="#stale-objects"><img src="https://i.ibb.co/35xJt8TM/Stale-Objectsico.png" alt="Stale-Objectsico" border="0"></a><div class="kpi-value">127</div></div>
                </div>
            </div>
             <div class="description-box">
                <p><strong>Key Metrics Explained:</strong></p>
                <ul>
                    <li><strong>Domain Controllers:</strong> Servers that manage user authentication and access to network resources.</li>
                    <li><strong>Privileged Accounts:</strong> High-level administrator accounts that have extensive access and control over your systems.</li>
                    <li><strong>Stale Objects:</strong> Inactive user accounts, computers, or groups that haven't been used for 90 days or more.</li>
                </ul>
            </div>
        </div><br>
         <div class="card expanded" id="quick-guide">
            <div class="card-header" onclick="toggleCard(this)">Quick Guide to This Report <span class="toggle">−</span></div>     
            <div class="card-body" id="quick-guide-content">
                <div class="guide-section">
                    <h4>How to Navigate This Report</h4>
                    <ul>
                        <li>Use the sidebar on the left to jump to different sections</li>
                        <li>Click on section headers to expand or collapse content</li>
                        <li>Click on tabs to switch between related information</li>
                        <li>Use search boxes to filter table contents</li>
                    </ul>
                </div>
                <div class="guide-section">
                    <h4>Understanding the Report</h4>
                    <ul> 
                        <li><strong>Executive Summary:</strong> High-level overview with key metrics</li>
                        <li><strong>Security Indicators:</strong> Basic information about your AD environment</li>
                        <li><strong>Maturity Level:</strong> How well your AD follows security best practices</li>
                        <li><strong>Attack Vectors:</strong> Potential security vulnerabilities</li>
                        <li><strong>Stale Objects:</strong> Unused accounts that could pose risks</li>
                        <li><strong>Recommendations:</strong> Suggested actions to improve security</li>
                    </ul>
                </div>
                <div class="guide-section">
                    <h4>Key Icons and Colors</h4>
                    <div class="icon-guide">
                        <div><span class="status status-success">Success</span> Good configuration - no action needed</div>
                        <div><span class="status status-warning">Warning</span> Potential issue - should be reviewed</div>
                        <div><span class="status status-danger">Danger</span> Critical issue - needs immediate attention</div>
                        <div><i class="info-icon">ℹ️</i> Information boxes explain technical concepts</div>
                    </div>
                </div>
                <div class="guide-section">
                    <h4>Need Help?</h4>
                    <p>If you're unfamiliar with a term, check the <a href="#glossary">Glossary</a> section. For additional help, contact your IT department or <a href="mailto:support@clouddestinations.com">Cloud Destinations Support</a>.</p>
                </div>
            </div>
        </div>
        <div class="card expanded" id="security-indicators">
            <div class="card-header" onclick="toggleCard(this)">Security Indicators <span class="toggle">−</span></div>
            <div class="card-body">
                <div class="tabs">
                    <div class="tab active" onclick="showTab(event, 'tab-domain-info')">Domain Info</div>
                    <div class="tab" onclick="showTab(event, 'tab-controllers')">DCs</div>
                    <div class="tab" onclick="showTab(event, 'tab-trusts')">Trusts</div>
                    <div class="tab" onclick="showTab(event, 'tab-privileged')" id="privileged-acc">Privileged Groups</div>
                    <div class="tab" onclick="showTab(event, 'tab-recommendations')">Recommendations(15, 3 Stale)</div>
                </div>
                <div id="tab-domain-info" class="tab-content active">
                    <h3>Domain Information</h3>
                    <p class="tab-description">Basic information about your Active Directory domain and forest structure.</p>
                    <table>
                        <tr><th>Domain Name</th><td>contoso.local</td></tr>
                        <tr><th>Forest Name</th><td>contoso.com</td></tr>
                        <tr><th>Domain Mode</th><td>Windows2016Domain</td></tr>
                        <tr><th>Forest Mode</th><td>Windows2016Forest</td></tr>
                        <tr><th>Domain SID</th><td>S-1-5-21-3623811015-3361044348-30300820</td></tr>
                        <tr><th>PDC Emulator</th><td>DC01.contoso.local</td></tr>
                        <tr><th>RID Master</th><td>DC01.contoso.local</td></tr>
                        <tr><th>Infrastructure Master</th><td>DC01.contoso.local</td></tr>
                    </table>
                </div>
                <div id="tab-controllers" class="tab-content">
                    <h3>Domain Controllers</h3>
                    <p class="tab-description">Domain Controllers are the servers that manage authentication and directory services for your network. They are critical components that need to be protected.</p>
                    <table id="dcTable" class="display">
                        <thead><tr><th>Name</th><th>Site</th><th>IP Address</th><th>Global Catalog</th><th>Read-Only</th></tr></thead>
                        <tbody>#DC_TABLE_ROWS#</tbody>
                    </table>
                </div>            
                <div id="tab-trusts" class="tab-content">
                    <h3>Domain Trusts</h3>
                    <p class="tab-description">Trust relationships allow users from one domain to access resources in another domain. These connections can introduce security risks if not properly managed.</p>
                    <table id="trustTable" class="display">
                        <thead><tr><th>Target Domain</th><th>Type</th><th>Direction</th><th>Transitive</th><th>SID Filtering</th><th>Selective Auth</th><th>Risk</th></tr></thead>
                        <tbody>#TRUST_TABLE_ROWS#</tbody>
                    </table>
                </div>                         
                <div id="tab-privileged" class="tab-content">
                    <h3>Privileged Group Membership</h3>
                    <p class="tab-description">Privileged groups contain users with high-level access rights. These accounts should be closely monitored as they are prime targets for attackers.</p>
                    <table id="privTable" class="display">
                        <thead><tr><th>Group</th><th>Member Name</th><th>SAM Account Name</th><th>Object Type</th></tr></thead>
                        <tbody>#PRIV_ACCOUNTS_TABLE_ROWS#</tbody>
                    </table>
                </div>
                 <div id="tab-recommendations" class="tab-content">
                    <h4>Secure Privileged Accounts</h4>
                    <p class="tab-description">15 privileged accounts found, 3 stale.</p>
                    <ul>
                       <li>Review membership in #PRIV_GROUP_LIST#.</li>
                        <li>Manage 3 stale privileged accounts.</li>
                        <li>Implement Tiered Admin model.</li>
                        <li>Use PAWs for Tier 0 tasks.</li>
                        <li>Enforce MFA for admins.</li>
                        <li>Rotate krbtgt password (10 days old). #KRBTGT_RECOMMENDATION#</li>
                        <li>Remediate #UNCONSTRAINED_DELEGATION_COUNT# unconstrained delegations.</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="card" id="ad-maturity">
            <div class="card-header" onclick="toggleCard(this)">AD Maturity Level <span class="toggle">+</span></div>
            <div class="card-body">
                 <div class="tabs">
                    <div class="tab active" onclick="showTab(event, 'Maturity_tab')">Maturity Score Details</div>
                    <div class="tab" onclick="showTab(event, 'Password_Policy')">Password Policy</div>
                    <div class="tab" onclick="showTab(event, 'Kerberos_Policy')">Kerberos Policy</div>
                    <div class="tab" onclick="showTab(event, 'Maturity_Findings')">Maturity Findings</div>
                    <div class="tab" onclick="showTab(event, 'recommendations')">Recommendations</div>
                </div>
                <div id="Maturity_tab" class="tab-content active">
                 <h3>Maturity Score: <span class="status status-success">7.5/10</span> (Advanced)</h3>
                <div class="description-box">
                    <p>The maturity score evaluates how well your Active Directory follows security best practices. A higher score means better protection against common security threats.</p>
                </div>
                   <div class="maturity-grid">
                    <div class="maturity-card">
                        <h4><i class="fas fa-shield-alt"></i> High Maturity</h4>
                        <span class="maturity-level level-high">7-10 points</span>
                        <p>Strong security posture with most best practices implemented. Your AD environment is well-protected against common threats.</p>
                    </div>
                    <div class="maturity-card">
                        <h4><i class="fas fa-shield-alt"></i> Medium Maturity</h4>
                        <span class="maturity-level level-medium">4-6 points</span>
                        <p>Moderate security with some improvements needed. Consider addressing missing security controls.</p>
                    </div>
                    <div class="maturity-card">
                        <h4><i class="fas fa-shield-alt"></i> Low Maturity</h4>
                        <span class="maturity-level level-low">0-3 points</span>
                        <p>Significant security improvements required. Immediate attention needed to implement security controls.</p>
                    </div>
                </div><br>
                <table class="score-table">
                    <thead>
                        <tr>
                            <th>Security Control</th>
                            <th>Criteria</th>
                            <th>Max Points</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Password Complexity</td>
                            <td>Enabled</td>
                            <td><span class="points-badge">1 point</span></td>
                        </tr>
                        <tr>
                            <td>Password Length</td>
                            <td>≥14 chars (2pts)<br>8-13 chars (1pt)</td>
                            <td><span class="points-badge">2 points</span></td>
                        </tr>
                        <tr>
                            <td>Password History</td>
                            <td>≥24 passwords remembered</td>
                            <td><span class="points-badge">1 point</span></td>
                        </tr>
                        <tr>
                            <td>Reversible Encryption</td>
                            <td>Disabled</td>                         
                            <td><span class="points-badge">1 point</span></td>
                        </tr>
                        <tr>
                            <td>Kerberos Ticket Age</td>
                            <td>≤10 hours</td>                      
                            <td><span class="points-badge">1 point</span></td>
                        </tr>
                        <tr>
                            <td>KRBTGT Password Age</td>
                            <td><365 days</td>                        
                            <td><span class="points-badge">2 points</span></td>
                        </tr>
                        <tr>
                            <td>LAPS Implementation</td>
                            <td>Detected</td>                           
                            <td><span class="points-badge">1 point</span></td>
                        </tr>
                        <tr>
                            <td>AdminSDHolder Protection</td>
                            <td>Active protection</td>                           
                            <td><span class="points-badge">1 point</span></td>
                        </tr>
                    </tbody>
                </table><br>
                </div>
                <div id="Password_Policy" class="tab-content">
                <h4>Password Policy</h4>
                <p class="tab-description">Settings that control password requirements for user accounts, such as complexity and expiration.</p>
                <table>
                    <tr><th>Complexity Enabled</th><td>Enabled</td></tr>
                    <tr><th>Minimum Length</th><td>14</td></tr>
                    <tr><th>Maximum Age (Days)</th><td>90</td></tr>
                    <tr><th>History Count</th><td>24</td></tr>
                    <tr><th>Reversible Encryption</th><td>Disabled</td></tr>
                    <tr><th>Lockout Threshold</th><td>5</td></tr>
                    <tr><th>Lockout Duration (Mins)</th><td>30</td></tr>
                    <tr><th>Lockout Reset (Mins)</th><td>30</td></tr>
                </table>
                </div>
                <div id="Kerberos_Policy" class="tab-content">
                <h4>Kerberos Policy</h4>
                <p class="tab-description">Kerberos is the authentication protocol used by Active Directory. These settings control ticket lifetimes and other security parameters.</p>
                <table>
                    <tr><th>Max Ticket Age (Hours)</th><td>10</td></tr>
                    <tr><th>Max Renew Age (Days)</th><td>7</td></tr>
                    <tr><th>Max Service Age (Mins)</th><td>600</td></tr>
                    <tr><th>Max Clock Skew (Mins)</th><td>5</td></tr>
                    <tr><th>Enforce Logon Restrictions</th><td>Yes</td></tr>
                </table>
                </div>
                <div id="Maturity_Findings" class="tab-content">
                <h4>Maturity Findings</h4>
                <p class="tab-description">Specific areas where your Active Directory security can be improved, based on industry best practices.</p>
                <ul>#MATURITY_FINDINGS#</ul>
                </div>
                 <div id="recommendations" class="tab-content">
                    <h4>Strengthen Password & Kerberos</h4>
                   <ul>
                        <li>Increase min password length to 14 (#PWD_LENGTH_RECOMMENDATION#).</li>
                        <li>Ensure complexity is enabled.</li>
                        <li>Set password history to 24+ (Current: 24).</li>
                        <li>Disable reversible encryption (Current setting is optimal).</li>
                        <li>Adjust Kerberos ticket age (10 hrs) to 10 hrs. #KERBEROS_AGE_RECOMMENDATION#</li>
                        <li>Limit 'Password Never Expires' (8 found).</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="card" id="attack-vectors">
            <div class="card-header" onclick="toggleCard(this)">Common Attack Vectors <span class="toggle">+</span></div>
            <div class="card-body">
                <h3>Attack Vector Checks</h3>
                    <p class="tab-description">This section identifies potential security vulnerabilities that attackers might exploit to gain unauthorized access to your systems. Addressing these issues is crucial for protecting your organization.</p>
                <table id="attackTable" class="display">
                    <thead><tr><th>Technique</th><th>Description</th><th>Status</th></tr></thead>
                    <tbody>#ATTACK_FINDINGS#</tbody>
                </table>
            </div>
        </div>
        <div class="card" id="stale-objects">
            <div class="card-header" onclick="toggleCard(this)">Stale Objects (127) <span class="toggle">+</span></div>
            <div class="card-body">
                <div class="tabs">
                    <div class="tab active" onclick="showTab(event, 'tab-stale-users')">Users (85)</div>
                    <div class="tab" onclick="showTab(event, 'tab-stale-computers')">Computers (35)</div>
                    <div class="tab" onclick="showTab(event, 'tab-stale-groups')">Groups (7)</div>
                    <div class="tab" onclick="showTab(event, 'tab-stale-privileged')">Privileged (15)</div>
                    <div class="tab" onclick="showTab(event, 'tab-stale-recommendations')">Recommendations (127)</div>
                </div>
                <div id="tab-stale-users" class="tab-content active">
                    <h4>Users Inactive (90+ Days)</h4>
                    <p class="tab-description">User accounts that haven't logged in for an extended period. These could be former employees or test accounts that should be disabled.</p>
                    <table id="staleUsersTable" class="display">
                        <thead><tr><th>Name</th><th>SAM Account Name</th><th>Last Logon</th><th>DN</th></tr></thead>
                        <tbody>#STALE_USERS_TABLE_ROWS#</tbody>
                    </table>
                </div>
                <div id="tab-stale-computers" class="tab-content">
                    <h4>Computers Inactive (90+ Days)</h4>
                    <p class="tab-description">Computer accounts that haven't connected to the domain recently. These might be decommissioned or replaced devices.</p>
                    <table id="staleComputersTable" class="display">
                        <thead><tr><th>Name</th><th>DNS Hostname</th><th>Last Logon</th><th>OS</th></tr></thead>
                        <tbody>#STALE_COMPUTERS_TABLE_ROWS#</tbody>
                    </table>
                </div>
                <div id="tab-stale-groups" class="tab-content">
                    <h4>Empty Groups</h4>
                    <p class="tab-description">Security groups that have no members, which might indicate obsolete access controls.</p>
                    <table id="staleGroupsTable" class="display">
                        <thead><tr><th>Name</th><th>DN</th></tr></thead>
                        <tbody>#STALE_GROUPS_TABLE_ROWS#</tbody>
                    </table>
                </div>
                <div id="tab-stale-privileged" class="tab-content">
                    <h4>Stale Privileged (90+ Days)</h4>
                    <p class="tab-description">High-privilege accounts that haven't been used recently. These are particularly concerning as they have extensive access rights.</p>
                    <table id="stalePrivTable" class="display">
                        <thead><tr><th>Name</th><th>SAM Account Name</th><th>Group</th><th>Last Logon</th></tr></thead>
                        <tbody>#STALE_PRIV_TABLE_ROWS#</tbody>
                    </table>
                </div>
                  <div id="tab-stale-recommendations" class="tab-content">
                    <h4>Clean Up Stale Objects</h4>
                    <p class="tab-description">127 stale objects detected (85 users, 35 computers).</p>
                    <ul>
                        <li>Review stale users and computers in 'Stale Objects'.</li>
                        <li>Disable accounts inactive for 90 days.</li>
                        <li>Delete disabled accounts after 90-180 days.</li>
                        <li>Clean up 7 empty groups.</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="card" id="ad-anomalies">
            <div class="card-header" onclick="toggleCard(this)">AD Anomalies <span class="toggle">+</span></div>
            <div class="card-body">
                <div class="tabs">
                    <div class="tab active" onclick="showTab(event, 'tab-locked')">Locked (3)</div>
                    <div class="tab" onclick="showTab(event, 'tab-disabled-admins')">Disabled Admins (2)</div>
                    <div class="tab" onclick="showTab(event, 'tab-never-expire')">Never Expire (0)</div>
                    <div class="tab" onclick="showTab(event, 'tab-sid-history')">SID History (0)</div>
                </div>
                <div id="tab-locked" class="tab-content active">
                    <h4>Locked Out Users</h4>
                    <p class="tab-description">Accounts that are currently locked due to failed login attempts. This could indicate password guessing attacks.</p>
                    <table id="lockedTable" class="display">
                        <thead><tr><th>Name</th><th>SAM Account Name</th><th>Last Bad Password</th></tr></thead>
                        <tbody>#LOCKED_USERS_TABLE_ROWS#</tbody>
                    </table>
                </div>
                <div id="tab-disabled-admins" class="tab-content">
                    <h4>Disabled Admins</h4>
                    <p class="tab-description">Administrator accounts that have been disabled but still exist in privileged groups.</p>
                    <table id="disabledAdminsTable" class="display">
                        <thead><tr><th>Name</th><th>SAM Account Name</th><th>DN</th></tr></thead>
                        <tbody>#DISABLED_ADMINS_TABLE_ROWS#</tbody>
                    </table>
                </div>
                <div id="tab-never-expire" class="tab-content">
                    <h4>Passwords Never Expire</h4>
                    <p class="tab-description">Accounts with passwords set to never expire, which is a security risk as passwords should be changed regularly.</p>
                    <table id="neverExpireTable" class="display">
                        <thead><tr><th>Name</th><th>SAM Account Name</th><th>Password Last Set</th><th>Admin Count</th></tr></thead>
                        <tbody>#NEVER_EXPIRE_TABLE_ROWS#</tbody>
                    </table>
                </div>
                <div id="tab-sid-history" class="tab-content">
                    <h4>SID History</h4>
                    <p class="tab-description">Accounts with multiple SIDs, which might indicate multiple accounts for a single user.</p>
                    <table id="sidHistoryTable" class="display">
                        <thead><tr><th>Name</th><th>SAM Account Name</th><th>SID Count</th></tr></thead>
                        <tbody>#SID_HISTORY_TABLE_ROWS#</tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="card" id="computer-inventory">
            <div class="card-header" onclick="toggleCard(this)">Computer Inventory (345) <span class="toggle">+</span></div>
            <div class="card-body">
                <div class="tabs">
                    <div class="tab active" onclick="showTab(event, 'tab-os-summary')">OS Summary</div>
                    <div class="tab" onclick="showTab(event, 'tab-computer-list')">Computer List</div>
                    <div class="tab" onclick="showTab(event, 'tab-laps')">LAPS (320)</div>
                    <div class="tab" onclick="showTab(event, 'tab-laps-recommendations')">LAPS Recommendations</div>
                </div>
                <div id="tab-os-summary" class="tab-content active">
                    <h4>OS Distribution</h4>
                    <p class="tab-description">Breakdown of operating systems used across your organization. This helps identify older, potentially vulnerable systems.</p>
                    <div class="chart-container"><canvas id="osChart"></canvas></div>
                    <table id="osSummaryTable" class="display">
                        <thead><tr><th>Operating System</th><th>Count</th><th>Percentage</th></tr></thead>
                        <tbody>#OS_SUMMARY_TABLE_ROWS#</tbody>
                    </table>
                </div>
                <div id="tab-computer-list" class="tab-content">
                    <h4>All Computers</h4>
                    <p class="tab-description">A list of all computers in your organization, including their operating system, version, and last logon date.</p>
                    <table id="computerListTable" class="display">
                        <thead><tr><th>Name</th><th>OS</th><th>OS Version</th><th>Enabled</th><th>Last Logon</th></tr></thead>
                        <tbody>#COMPUTER_LIST_TABLE_ROWS#</tbody>
                    </table>
                </div>
                <div id="tab-laps" class="tab-content">
                    <h4>LAPS Status</h4>
                    <p class="tab-description">Complete list of computer accounts in your Active Directory, including their status and operating system information.</p>
                    <table id="lapsTable" class="display">
                        <thead><tr><th>Name</th><th>Expiration Time</th><th>Status</th></tr></thead>
                        <tbody>#LAPS_TABLE_ROWS#</tbody>
                    </table>
                </div>
                <div id="tab-laps-recommendations" class="tab-content">
                    <h4>Improve AD Monitoring</h4>
                    <ul>
                        <li>Forward logs to SIEM (Event IDs: 4624, 4768, etc.).</li>
                        <li>Deploy Defender for Identity.</li>
                        <li>Patch DCs and servers.</li>
                        <li>Ensure LAPS on all systems (25 missing).</li>
                        <li>Secure trusts (2 found).</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="card" id="gpos">
            <div class="card-header" onclick="toggleCard(this)">Group Policy Objects (150) <span class="toggle">+</span></div>
            <div class="card-body">
                <div class="tabs">
                    <div class="tab active" onclick="showTab(event, 'tab-gpo-overview')">Overview</div>
                    <div class="tab" onclick="showTab(event, 'tab-gpo-health')">Health Check</div>
                    <div class="tab" onclick="showTab(event, 'tab-gpo-issues')">Issues</div>
                    <div class="tab" onclick="showTab(event, 'tab-gpo-filters')">Filters</div>
                    <div class="tab" onclick="showTab(event, 'tab-gpo-recommendations')">Recommendations</div>
                </div>
                
                <div id="tab-gpo-overview" class="tab-content active">
                    <h4>GPO Overview</h4>
                    <p class="tab-description">Complete list of Group Policy Objects in your Active Directory, including their status and last modification times.</p>
                    
                    <div class="chart-container-wrapper" style="display: flex; gap: 20px; margin: 20px 0; height: 350px;">
                        <div class="chart-box" style="flex: 1; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); position: relative;">
                            <h5 style="margin-top: 0; text-align: center;">GPO Health Status</h5>
                            <div style="position: relative; height: 280px;">
                                <canvas id="gpoHealthChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-box" style="flex: 2; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); position: relative;">
                            <h5 style="margin-top: 0; text-align: center;">GPO Metrics</h5>
                            <div style="position: relative; height: 280px;">
                                <canvas id="gpoMetricsChart"></canvas>
                            </div>
                        </div>
                    </div>

                    #GPO_HEALTH_SUMMARY#
                    <table id="gpoTable" class="display">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Status</th>
                                <th>Created</th>
                                <th>Modified</th>
                                <th>Health</th>
                            </tr>
                        </thead>
                        <tbody>#GPO_TABLE_ROWS#</tbody>
                    </table>
                </div>

                <div id="tab-gpo-health" class="tab-content">
                    <h4>GPO Health Details</h4>
                    <p class="tab-description">Detailed health metrics for your Group Policy Objects, including replication status and version consistency.</p>
                    
                    <div class="collapsible" onclick="toggleCollapsible(this)">Version Mismatches (2)</div>
                    <div class="collapsible-content">
                        <table class="display">
                            <thead><tr><th>GPO Name</th><th>DC</th><th>Version</th></tr></thead>
                            <tbody>#VERSION_MISMATCH_ROWS#</tbody>
                        </table>
                    </div>

                    <div class="collapsible" onclick="toggleCollapsible(this)">SYSVOL/GPC Mismatches (1)</div>
                    <div class="collapsible-content">
                        <table class="display">
                            <thead><tr><th>GPO Name</th><th>GPC Version</th><th>SYSVOL Version</th></tr></thead>
                            <tbody>#SYSVOL_MISMATCH_ROWS#</tbody>
                        </table>
                    </div>

                    <div class="collapsible" onclick="toggleCollapsible(this)">Large/Complex GPOs (0)</div>
                    <div class="collapsible-content">
                        <table class="display">
                            <thead><tr><th>GPO Name</th><th>Size (MB)</th><th>Settings Count</th></tr></thead>
                            <tbody>#LARGE_GPO_ROWS#</tbody>
                        </table>
                    </div>
                </div>

                <div id="tab-gpo-issues" class="tab-content">
                    <h4>GPO Issues</h4>
                    <p class="tab-description">Potential issues detected with Group Policy Objects that may require attention.</p>
                    
                    <div class="collapsible" onclick="toggleCollapsible(this)">Stale GPOs (0)</div>
                    <div class="collapsible-content">
                        <table class="display">
                            <thead><tr><th>Name</th><th>Last Modified</th><th>Days Since Update</th></tr></thead>
                            <tbody>#STALE_GPO_ROWS#</tbody>
                        </table>
                    </div>

                    <div class="collapsible" onclick="toggleCollapsible(this)">Disabled/Unlinked GPOs (0)</div>
                    <div class="collapsible-content">
                        <table class="display">
                            <thead><tr><th>Name</th><th>Status</th><th>Issue</th></tr></thead>
                            <tbody>#DISABLED_UNLINKED_ROWS#</tbody>
                        </table>
                    </div>

                    <div class="collapsible" onclick="toggleCollapsible(this)">Empty GPOs (0)</div>
                    <div class="collapsible-content">
                        <table class="display">
                            <thead><tr><th>Name</th><th>Created Date</th></tr></thead>
                            <tbody>#EMPTY_GPO_ROWS#</tbody>
                        </table>
                    </div>

                    <div class="collapsible" onclick="toggleCollapsible(this)">Recent Processing Errors (0)</div>
                    <div class="collapsible-content">
                        <table class="display">
                            <thead><tr><th>Time</th><th>DC</th><th>Event ID</th><th>Message</th></tr></thead>
                            <tbody>#GPO_ERROR_ROWS#</tbody>
                        </table>
                    </div>
                </div>

                <div id="tab-gpo-filters" class="tab-content">
                    <h4>GPO Filters</h4>
                    <p class="tab-description">Group Policy Objects using WMI or security filtering, and those containing scripts.</p>
                    
                    <div class="collapsible" onclick="toggleCollapsible(this)">WMI Filtered GPOs (0)</div>
                    <div class="collapsible-content">
                        <table class="display">
                            <thead><tr><th>GPO Name</th><th>WmiFilter</th></tr></thead>
                            <tbody>#WMI_FILTER_ROWS#</tbody>
                        </table>
                    </div>

                    <div class="collapsible" onclick="toggleCollapsible(this)">Security Filtered GPOs (0)</div>
                    <div class="collapsible-content">
                        <table class="display">
                            <thead><tr><th>GPO Name</th><th>Security Filters</th></tr></thead>
                            <tbody>#SECURITY_FILTER_ROWS#</tbody>
                        </table>
                    </div>

                    <div class="collapsible" onclick="toggleCollapsible(this)">Script-enabled GPOs (0)</div>
                    <div class="collapsible-content">
                        <table class="display">
                            <thead><tr><th>GPO Name</th><th>Script Type</th></tr></thead>
                            <tbody>#SCRIPT_GPO_ROWS#</tbody>
                        </table>
                    </div>
                </div>

                <div id="tab-gpo-recommendations" class="tab-content">
                    <h4>GPO Recommendations</h4>
                    <p class="tab-description">Actionable recommendations based on the analysis of your Group Policy Objects.</p>
                    
                    <div class="recommendations-container" style="display: grid; gap: 20px; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));">
                        <div class="recommendation-card critical" style="background: #fef2f2; border-left: 4px solid #ef4444; padding: 20px; border-radius: 8px;">
                            <h5 style="color: #b91c1c; margin-top: 0;">Critical Actions</h5>
                            <ul style="margin: 0; padding-left: 20px; color: #7f1d1d;">
                                #GPO_CRITICAL_RECOMMENDATIONS#
                            </ul>
                        </div>

                        <div class="recommendation-card warning" style="background: #fffbeb; border-left: 4px solid #f59e0b; padding: 20px; border-radius: 8px;">
                            <h5 style="color: #92400e; margin-top: 0;">Maintenance Required</h5>
                            <ul style="margin: 0; padding-left: 20px; color: #78350f;">
                                #GPO_WARNING_RECOMMENDATIONS#
                            </ul>
                        </div>

                        <div class="recommendation-card info" style="background: #f0f9ff; border-left: 4px solid #3b82f6; padding: 20px; border-radius: 8px;">
                            <h5 style="color: #1e40af; margin-top: 0;">Best Practices</h5>
                            <ul style="margin: 0; padding-left: 20px; color: #1e3a8a;">
                                #GPO_BEST_PRACTICE_RECOMMENDATIONS#
                            </ul>
                        </div>

                        <div class="recommendation-card optimization" style="background: #f0fdf4; border-left: 4px solid #22c55e; padding: 20px; border-radius: 8px;">
                            <h5 style="color: #166534; margin-top: 0;">Optimization Opportunities</h5>
                            <ul style="margin: 0; padding-left: 20px; color: #14532d;">
                                #GPO_OPTIMIZATION_RECOMMENDATIONS#
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card" id="glossary">
            <div class="card-header" onclick="toggleCard(this)">Glossary of Terms<span class="toggle">+</span></div>
            <div class="card-body">
                <p class="tab-description">This glossary explains common terms used in Active Directory and in this report. It's designed to help non-technical users understand the terminology.</p>
                <div class="glossary-container">
                    <div class="glossary-item">
                        <h4>Active Directory (AD)</h4>
                        <p>Microsoft's directory service that stores information about objects on a network and makes this information available to users and administrators.</p>
                    </div>
                    
                    <div class="glossary-item">
                        <h4>Domain Controller (DC)</h4>
                        <p>A server that responds to security authentication requests in a Windows domain. It's responsible for allowing users to access domain resources.</p>
                    </div>
                    
                    <div class="glossary-item">
                        <h4>Forest</h4>
                        <p>A collection of one or more Active Directory domains that share a common schema, configuration, and global catalog.</p>
                    </div>
                    
                    <div class="glossary-item">
                        <h4>Group Policy Object (GPO)</h4>
                        <p>A collection of settings that define what a system will look like and how it will behave for a defined group of users.</p>
                    </div>
                    
                    <div class="glossary-item">
                        <h4>Kerberos</h4>
                        <p>The default authentication protocol used by Microsoft Windows. It's designed to provide strong authentication for client/server applications.</p>
                    </div>
                    
                    <div class="glossary-item">
                        <h4>LAPS (Local Administrator Password Solution)</h4>
                        <p>A Microsoft solution that manages local administrator passwords on domain-joined computers, automatically changing them regularly and storing them securely in Active Directory.</p>
                    </div>
                    
                    <div class="glossary-item">
                        <h4>Privileged Account</h4>
                        <p>User accounts with elevated permissions that can make significant changes to systems, such as Domain Administrators.</p>
                    </div>
                    
                    <div class="glossary-item">
                        <h4>SID (Security Identifier)</h4>
                        <p>A unique identifier assigned to each user, group, and computer account in Windows. Used to track and manage access to resources.</p>
                    </div>
                    
                    <div class="glossary-item">
                        <h4>Stale Object</h4>
                        <p>User accounts, computers, or groups that haven't been used for an extended period of time (typically 90+ days).</p>
                    </div>
                    
                    <div class="glossary-item">
                        <h4>Trust Relationship</h4>
                        <p>A link between domains that allows users in one domain to access resources in another domain.</p>
                    </div>
                    
                    <div class="glossary-item">
                        <h4>MFA (Multi-Factor Authentication)</h4>
                        <p>A security system that requires more than one method of authentication to verify a user's identity, typically combining something you know (password) with something you have (phone/token).</p>
                    </div>
                    
                    <div class="glossary-item">
                        <h4>Password Policy</h4>
                        <p>Settings that define the requirements for passwords in your organization, such as minimum length, complexity, and expiration period.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="report-actions" style="margin: 20px 0; text-align: right;">
            <button class="export-btn" onclick="window.print()">🖨️ Print Report</button>
        </div>
    </div>
    <div class="footer">
        <img src="https://i.ibb.co/Sw37bHqc/cdlogo-full.png" alt="Cloud Destinations Logo" class="footer-logo">
        <p>© 2025 Cloud Destinations. All Rights Reserved.</p>
        <p>Simplifying Active Directory Server Visibility with Speed and Precision</p>
        <div class="footer-links">
            <a href="https://www.clouddestinations.com">Website</a>
            <a href="https://docs.clouddestinations.com">Documentation</a>
            <a href="mailto:support@clouddestinations.com">Support</a>
        </div>
    </div>
    </div>
    <script>
        function toggleCard(element) {
            const card = element.parentElement;
            card.classList.toggle('expanded');
            element.querySelector('.toggle').textContent = card.classList.contains('expanded') ? '−' : '+';
        }
        function showTab(event, tabId) {
            const cardBody = event.target.closest('.card-body');
            cardBody.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
            cardBody.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            cardBody.querySelector('#' + tabId).classList.add('active');
            event.target.classList.add('active');
        }
        function toggleCollapsible(element) {
            const content = element.nextElementSibling;
            content.style.display = content.style.display === 'block' ? 'none' : 'block';
        }
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('collapsed');
        }
        function exportPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.html(document.body, {
                callback: doc => doc.save('AD_Security_Report.pdf'),
                x: 10,
                y: 10,
                width: 190,
                windowWidth: 1000
            });
        }
        document.addEventListener('DOMContentLoaded', () => {
            // Maturity Gauge
            const maturityCtx = document.getElementById('maturityGauge').getContext('2d');
            new Chart(maturityCtx, {
                type: 'doughnut',
                data: {
                    datasets: [{
                        data: [7.5, 2.5],
                        backgroundColor: ['#3498db', '#e0e0e0'],
                        borderWidth: 0
                    }]
                },
                options: { circumference: 180, rotation: -90, cutout: '70%', plugins: { legend: { display: false } } }
            });

            // OS Chart
            const osCtx = document.getElementById('osChart').getContext('2d');
            new Chart(osCtx, {
                type: 'bar',
                data: {
                    labels: ['Windows Server 2019', 'Windows Server 2016', 'Windows 10', 'Windows 11'],
                    datasets: [{ label: 'Count', data: [45, 25, 180, 95], backgroundColor:  ['#3498db','#77d6d0','#c59cff','#ffbe88'] }]
                },
                options: { scales: { y: { beginAtZero: true } }, responsive: true }
            });

            // GPO Health Status Chart
            const gpoHealthCtx = document.getElementById('gpoHealthChart').getContext('2d');
            new Chart(gpoHealthCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Healthy', 'Warning', 'Critical'],
                    datasets: [{
                        data: [85, 12, 3],
                        backgroundColor: ['#2ecc71', '#f1c40f', '#e74c3c'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    layout: {
                        padding: {
                            top: 10,
                            bottom: 10
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                boxWidth: 12,
                                padding: 15
                            }
                        },
                        title: {
                            display: false
                        }
                    }
                }
            });

            // GPO Metrics Chart
            const gpoMetricsCtx = document.getElementById('gpoMetricsChart').getContext('2d');
            new Chart(gpoMetricsCtx, {
                type: 'bar',
                data: {
                    labels: ['Total GPOs', 'Linked', 'Unlinked', 'Disabled', 'Empty'],
                    datasets: [{
                        label: 'Count',
                        data: [150, 125, 15, 8, 2],
                        backgroundColor: '#3498db',
                        borderColor: '#2980b9',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    layout: {
                        padding: {
                            top: 10,
                            bottom: 10
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1,
                                font: {
                                    size: 11
                                }
                            },
                            grid: {
                                drawBorder: false
                            }
                        },
                        x: {
                            ticks: {
                                font: {
                                    size: 11
                                },
                                maxRotation: 45,
                                minRotation: 45
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: false
                        }
                    }
                }
            });

            // DataTables
            $('table.display').DataTable({ pageLength: 10, order: [[0, 'asc']] });
        });
            // Submenu Toggle   
            document.querySelectorAll('.submenu-toggle').forEach(toggle => {
            toggle.addEventListener('click', function (e) {
            e.stopPropagation(); // Prevents from triggering anchor navigation
            const parent = this.closest('.has-submenu');
            parent.classList.toggle('open');
            const submenu = parent.querySelector('.sub-menu');
            if (submenu) {
                submenu.style.display = parent.classList.contains('open') ? 'block' : 'none';
            }
        });
    });
    </script>
</body>
</html>